<!-- 新闻中心 -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>新闻中心</title>
    <meta name="keywords" content="新闻中心" />
    <meta name="description" content="新闻中心" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <script src="./js/flexible.js"></script>
    <link rel="stylesheet" type="text/css" href="./css/bootstrap-custom.css" />
    <script>
      document.write('<link href="./css/base.css?v='+ new Date().getTime()+'" rel="stylesheet" >');
      document.write('<link href="./css/header.css?v='+ new Date().getTime()+'" rel="stylesheet" >');
      document.write('<link href="./css/contact.css?v='+ new Date().getTime()+'" rel="stylesheet" >');
      document.write('<link href="./css/footer.css?v='+ new Date().getTime()+'" rel="stylesheet" >');
      document.write('<link href="./css/newsCenter.css?v='+new Date().getTime()+'" rel="stylesheet" >');
    </script>
    <script src="./js/jquery-1.12.4.js"></script>
    <script>
      document.write('<script src="./js/common.js?v=' + new Date().getTime() + '"><\/script>')
    </script>
    <script src="./js/bootstrap/bootstrap.js"></script>
    <script src="./js/bootstrap/bootstrap-paginator.min.js"></script>
  </head>
  <body>
    <div id="newsCenter">
      <!-- header -->
      <ul class="back_top">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li>
          <div class="back_top_icon"></div>
        </li>
      </ul>
      <div class="header clearfix">
        <a href="/" class="logo fl">
          <img src="./img/index/logo.png" alt="斗量传媒-logo" />
        </a>
        <ul class="header-nav fr">
          <li>
            <a href="/">首页</a>
          </li>
          <li>
            <a href="/dyop.html">抖音运营</a>
          </li>
          <li>
            <a href="/eclv.html">电商直播</a>
          </li>
          <li>
            <a href="/dypx.html">抖音培训</a>
          </li>
          <li>
            <a href="/ecop.html">电商运营</a>
          </li>
          <li>
            <a href="/mgwb.html">设计外包</a>
          </li>
          <li>
            <a href="/news.html">新闻资讯</a>
          </li>
          <li>
            <a href="/ctus.html">联系我们</a>
          </li>
        </ul>
      </div>
      <!-- banner -->
      <div class="banner">
        <img id="banner" style="width: 100%;" src="./img/newsCenter/banner.jpg" alt="新闻中心-banner">
      </div>
      <!-- news center -->
      <div class="news_center">
        <div class="title">
          <div>NEWS CENTER</div>
          <p>新闻中心</p>
        </div>
        <!-- 列表 -->
        <ul id="newsLists"></ul>
        </ul>
        <!-- 分页 -->
        <div style="text-align: center; position: relative; margin-top: 30px">
          <ul id="pageLimit"></ul>
          <select id="paginationSelect"></select>
        </div>
      </div>
      <!-- news_detail -->
      <div class="news_detail">
      </div>
      <!-- footer -->
      <div id="foot"></div>
    </div>
    <script>
      let arrlist = []
      $(document).ready(function () {
        $('.back_top li:last-child').click(function() {
            $('body,html').animate({scrollTop:0},500);
        })
        $.ajax({
          type: 'get',
          url: 'http://info.wkefu.com/api/activity2018/douLiangSearchNews',
          data: {
            'source':"2"
          },
          success: function(data) {
            if (data.resultCode == '0') {
              arrlist = data.resultData.map(item=>{
                return{
                  ...item,
                  month: item.createTime.slice(5,7),
                  day: item.createTime.slice(8,10)
                }
              })
               // 生成列表
              for (let i = 0; i < arrlist.length; i++) {
                let templates = `
                <li class="list_item clearfix">
                  <div class="new_date">
                    <div class="month">${arrlist[i].month}<span>/月</span></div>
                    <div class="day">${arrlist[i].day}<span>/日</span></div>
                  </div>
                  <div class="article"> 
                    <div class="head">${arrlist[i].title}</div>
                    <div class="main">
                      <div class="main_content">
                        ${arrlist[i].content}
                      </div>
                      <div class="check" onclick=detail("${arrlist[i].id}")>阅读全文 》</div>
                    </div>
                  </div>
                </li>
                `
                $("#newsLists").append(templates);
              }
              var page = 0; // 页数
              // 页数
              if ($("#newsLists>li").length % 10 == 0) {
                page = ($("#newsLists>li").length / 10) | 0;
              } else {
                page = (($("#newsLists>li").length / 10) | 0) + 1;
              }
              // 页数select框
              for (let i = 1; i < page + 1; i++) {
                let option = `
                <option value='${i}'>${i}</option>
                `;
                $("#paginationSelect").append(option);
              }
              //页面切换
              function changePage(index) {
                $('body,html').animate({scrollTop:0},0);
                for (var j = 0; j < $("#newsLists>li").length; j++) {
                  $("#newsLists>li")[j].style.display = "none";
                }
                for (var j = index * 10; j < (index + 1) * 10; j++) {
                  if ($("#newsLists>li")[j]) {
                    $("#newsLists>li")[j].style.display = "block";
                  }
                }
              }
              changePage(0);

              $("#pageLimit").bootstrapPaginator({
                currentPage: 1, //当前页面。
                totalPages: page,
                bootstrapMajorVersion: 3,
                numberOfPages: 10,
                size: "small",
                itemTexts: function (type, page, current) {
                  switch (type) {
                    case "first":
                      return "首页";
                    case "prev":
                      return "上一页";
                    case "next":
                      return "下一页";
                    case "last":
                      return "末页";
                    case "page":
                      return page;
                  }
                },
                onPageClicked: function (event, originalEvent, type, page) {
                  changePage(page - 1);
                  $("#paginationSelect").val(page);
                },
                itemContainerClass: function (type, page, current) {
                  // 首页末页按钮不高亮
                  if (page === current && type != "first" && type != "last") {
                    return "active";
                  } else {
                    return "";
                  }
                },
                shouldShowPage: function (type, page, current) {
                  // 首页末页不显示上一页下一页
                  var result = true;
                  switch (type) {
                    case "first":
                      result = true;
                      break;
                    case "prev":
                      result = current !== 1;
                      break;
                    case "next":
                      result = current !== this.totalPages;
                      break;
                    case "last":
                      result = true;
                      break;
                    case "page":
                      result = true;
                      break;
                  }
                  return result;
                },
              });
              $("#paginationSelect").change(function () {
                $("#pageLimit").bootstrapPaginator(
                  "show",
                  $("#paginationSelect").val()
                );
                changePage(+$("#paginationSelect").val() - 1);
              });
            }
          }
        });
      });

      function detail(id) {
        if(!id) {
          return
        }
        $('body,html').animate({scrollTop:0},0);
        $(".news_center").css("display", "none")
        $(".news_detail").empty();
        $(".news_detail").css("display", "block")
        let inID = ""
        let detail = arrlist.find((value, index, arr) => {
          if(value.id == id) inID = index
          return value.id == id
        })
        let tep = `
        <div class="crumbs w_1200">
          <img src="./img/newsCenter/home.png" alt="">
          <span>
            <a href="/">首页</a> > <a href="/newsList.html">新闻资讯</a> > 
            <span class="crumbs_title">${detail.title}</span>
          </span>
        </div>
        <div class="news_content w_1200">
          <div class="news_title">${detail.title}</div>
          <div class="news_date">${detail.createTime}</div>
          <div class="line"></div>
          <div class="main">
            ${detail.content}
          </div>
        </div>
        <div class="turn_page w_1200">
          <div>
            上一篇: <span onclick="detail(${arrlist[inID-1] ? arrlist[inID-1].id : "" })">${arrlist[inID-1] ? arrlist[inID-1].title : "没有了" }</span>
          </div>
          <div>
            下一篇: <span onclick="detail(${arrlist[inID+1] ? arrlist[inID+1].id : "" })">${arrlist[inID+1] ? arrlist[inID+1].title : "没有了" }</span>
          </div>
        </div>
        `
        $(".news_detail").append(tep);
      }
    </script>
  </body>
</html>
